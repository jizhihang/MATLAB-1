function out = JPSTsmooth(histo, smoothing);


l1 = length(histo);

switch (smoothing)
  case 0
    out = histo;
    return
    
  case 1
    GTAB1 =[ 0., 0., 0., 0., 0., 0., 0., 5.39910E-02,...
       2.41971E-01, 3.98942E-01, 2.41971E-01, 5.39910E-02,...
       0., 0., 0., 0., 0., 0., 0.];
    out = conv(histo, GTAB1);

  case 2
    GTAB2 =[ 0., 0., 0., 0., 0., 2.69955E-02, 6.47588E-02,...
       1.20985E-01, 1.76033E-01, 1.99471E-01, 1.76033E-01,...
       1.20985E-01, 6.47588E-02, 2.69955E-02, 0., 0., 0., 0., 0.];
    out = conv(histo, GTAB2);
   

  case 4
    GTAB4 =[ 7.9349130E-03, 1.3497742E-02, 2.1569330E-02,...
       3.2379400E-02, 4.5662273E-02, 6.0492679E-02, 7.5284354E-02,...
       8.8016331E-02, 9.6667029E-02, 9.9735573E-02, 9.6667029E-02,...
       8.8016331E-02, 7.5284354E-02, 6.0492679E-02, 4.5662273E-02,...
       3.2379400E-02, 2.1569330E-02, 1.3497742E-02, 7.9349130E-03];
    out = conv(histo, GTAB4);
       
end

l2 = length(out);
out = out((l2-l1)/2+1:end-(l2-l1)/2);